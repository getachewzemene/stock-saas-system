From 4f2094adaf4d2a6dee5e62e7ca603faafa16343d Mon Sep 17 00:00:00 2001
From: Z User <z@container>
Date: Sat, 23 Aug 2025 12:28:06 +0000
Subject: [PATCH] Add location filter functionality to locations page
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

- Add stock-based filter dropdown next to search input
- Implement filter options: All Locations, With Stock Items, No Stock Items
- Update filtering logic to combine search and stock filters
- Add Filter icon to filter dropdown for better UX
- Ensure responsive design for mobile and desktop layouts

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
---
 src/app/locations/page.tsx | 39 ++++++++++++++++++++++++++++++++------
 1 file changed, 33 insertions(+), 6 deletions(-)

diff --git a/src/app/locations/page.tsx b/src/app/locations/page.tsx
index 4893e30..0af8efc 100644
--- a/src/app/locations/page.tsx
+++ b/src/app/locations/page.tsx
@@ -20,6 +20,13 @@ import {
   DropdownMenuItem, 
   DropdownMenuTrigger 
 } from "@/components/ui/dropdown-menu";
+import { 
+  Select, 
+  SelectContent, 
+  SelectItem, 
+  SelectTrigger, 
+  SelectValue 
+} from "@/components/ui/select";
 import { Label } from "@/components/ui/label";
 import { Textarea } from "@/components/ui/textarea";
 import { 
@@ -33,7 +40,8 @@ import {
   Truck,
   RefreshCw,
   Building,
-  FileText
+  FileText,
+  Filter
 } from "lucide-react";
 import { toast } from "sonner";
 import { LayoutWrapper } from "@/components/layout/layout-wrapper";
@@ -58,6 +66,7 @@ interface Location {
 export default function LocationsPage() {
   const { t } = useI18n();
   const [searchTerm, setSearchTerm] = useState("");
+  const [stockFilter, setStockFilter] = useState("all");
   const [locations, setLocations] = useState<Location[]>([]);
   const [isLoading, setIsLoading] = useState(true);
   const [isDialogOpen, setIsDialogOpen] = useState(false);
@@ -165,11 +174,18 @@ export default function LocationsPage() {
   const getTotalTransfersCount = (location?: Location) => 
     getTransfersFromCount(location) + getTransfersToCount(location);
 
-  const filteredLocations = locations.filter(location =>
-    location.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
-    location.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||
-    location.address?.toLowerCase().includes(searchTerm.toLowerCase())
-  );
+  const filteredLocations = locations.filter(location => {
+    const matchesSearch = location.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
+      location.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||
+      location.address?.toLowerCase().includes(searchTerm.toLowerCase());
+    
+    const stockCount = getStockItemsCount(location);
+    const matchesStockFilter = stockFilter === "all" || 
+      (stockFilter === "withStock" && stockCount > 0) ||
+      (stockFilter === "noStock" && stockCount === 0);
+    
+    return matchesSearch && matchesStockFilter;
+  });
 
   const totalLocations = locations.length;
   const totalStockItems = locations.reduce((sum, loc) => sum + getStockItemsCount(loc), 0);
@@ -406,6 +422,17 @@ export default function LocationsPage() {
                     className="pl-10 w-full"
                   />
                 </div>
+                <Select value={stockFilter} onValueChange={setStockFilter}>
+                  <SelectTrigger className="w-full sm:w-48">
+                    <Filter className="w-4 h-4 mr-2" />
+                    <SelectValue />
+                  </SelectTrigger>
+                  <SelectContent>
+                    <SelectItem value="all">All Locations</SelectItem>
+                    <SelectItem value="withStock">With Stock Items</SelectItem>
+                    <SelectItem value="noStock">No Stock Items</SelectItem>
+                  </SelectContent>
+                </Select>
               </div>
             </div>
           </CardHeader>
-- 
2.39.5

